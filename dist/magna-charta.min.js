/*! Magna Charta - v0.1.0 - 2012-11-09
* https://github.com/alphagov/magna-charta
 */
(function(e){var t=function(){this.init=function(t,n){return this.setUpOptions(n),this.$table=e(t),this.$bodyRows=this.$table.find("tbody tr"),this.addClasses(),this.dimensions=this.calculateMaxWidth(),this.applyWidths(),this},this.setUpOptions=function(e){this.options=e||{},this.options.outOf=this.options.outOf||95},this.utils={isFloat:function(e){return!isNaN(parseFloat(e))},stripValue:function(e){return e.replace("%","").replace("Â£","").replace("m","")},returnMax:function(e){var t=0;for(var n=0;n<e.length;n++)e[n]>t&&(t=e[n]);return t}},this.addClasses=function(){this.$bodyRows.addClass("mc-row")},this.calculateMaxWidth=function(){var t=this,n={max:0,single:0},r=[];return this.$bodyRows.each(function(i,s){var o=e(s),u=o.find("td:not(:first)"),a=0;u.each(function(n,r){var i=e(r).addClass("mc-bar-cell"),s=t.utils.stripValue(i.text());t.utils.isFloat(s)&&(a+=parseFloat(s,10))}),r.push(a),n.max=parseFloat(t.utils.returnMax(r),10)}),n.single=parseFloat(this.options.outOf/n.max,10),n},this.applyWidths=function(){var t=this;this.$bodyRows.each(function(n,r){var i=e(r);i.find("td:not(:first)").each(function(n,r){var i=parseFloat(t.utils.stripValue(e(r).text()),10)*t.dimensions.single;e(r).css({width:i+"%"})})})}};e.magnaCharta=function(e){return(new t).init(e)}})(jQuery);